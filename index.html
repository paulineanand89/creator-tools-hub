<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Free AdSense Technical Readiness & SEO Pre-Checker</title>
  <style>
    body { font-family: Inter, Arial, sans-serif; background:#f5f7fa; margin:0; }
    header { background:#2d3748; color:#fff; padding:15px 30px; font-size:18px; font-weight:600; }
    .container { max-width:900px; margin:40px auto; background:#fff; border-radius:8px; box-shadow:0 4px 12px rgba(0,0,0,0.1); padding:30px; }
    h1 { font-size:24px; margin-bottom:10px; color:#2d3748; }
    textarea, input[type="text"] { width:100%; padding:12px; margin:10px 0; border:1px solid #cbd5e0; border-radius:6px; font-size:14px; }
    button { background:#3182ce; color:#fff; border:none; padding:12px 20px; border-radius:6px; font-size:14px; cursor:pointer; transition:background 0.2s; }
    button:hover { background:#2b6cb0; }
    .section { margin-top:20px; }
    .section h3 { margin-bottom:8px; color:#2d3748; }
    .item { margin-left:20px; }
    .score { margin-top:20px; font-size:18px; font-weight:600; color:#2d3748; }
    .verdict { font-size:16px; font-weight:600; margin-top:10px; }
    .low { color:green; }
    .medium { color:orange; }
    .high { color:red; }
    .footer { margin-top:30px; padding-top:15px; border-top:1px solid #e2e8f0; font-size:13px; color:#4a5568; }
  </style>
</head>
<body>
  <header>Free AdSense Technical Readiness & SEO Pre-Checker</header>
  <div class="container">
    <h1>Technical Audit & Eligibility Indicators</h1>
    <p>Paste HTML or enter a URL below:</p>
    <textarea id="htmlInput" rows="8" placeholder="Paste full HTML here..."></textarea>
    <input type="text" id="urlInput" placeholder="Or enter a full URL (https://...)">
    <button onclick="runChecker()">Run Pre-Check</button>
    <div id="output"></div>
  </div>

  <script>
    async function fetchHtml(url){
      try {
        const endpoint = "https://misty-credit-b188.paulineanand89.workers.dev/?url=" + encodeURIComponent(url);
        const res = await fetch(endpoint);
        if(!res.ok) return null;
        return await res.text();
      } catch(e) { return null; }
    }

    async function runChecker(){
      const htmlBox = document.getElementById("htmlInput");
      const urlBox = document.getElementById("urlInput");
      const out = document.getElementById("output");
      out.innerHTML = "<p>Checking...</p>";

      let html = htmlBox.value.trim();
      const url = urlBox.value.trim();

      if(!html && url){
        html = await fetchHtml(url);
        if(!html){
          out.innerHTML = "<p style='color:red'>Could not fetch this URL.</p>";
          return;
        }
      }
      if(!html || !url){
        out.innerHTML = "<p style='color:red'>Please paste HTML or enter a valid URL.</p>";
        return;
      }

      const lowerHtml = html.toLowerCase();
      const bodyText = html.replace(/<[^>]*>/g," ").trim();
      const wordCount = bodyText.split(/\s+/).length;

      // --- Checks grouped ---
      const technical = {
        "HTTPS": url.startsWith("https://"),
        "robots.txt": true, // simplified
        "ads.txt": lowerHtml.includes("google.com"),
        "canonical": html.includes("rel=\"canonical\"")
      };

      const seo = {
        "Title optimization": html.includes("<title>"),
        "Meta description": html.includes("name=\"description\""),
        "Header tags": html.includes("<h1")||html.includes("<h2"),
        "Content depth": wordCount>=800
      };

      const policy = {
        "Privacy Policy": lowerHtml.includes("privacy policy"),
        "About page": lowerHtml.includes("about"),
        "Contact page": lowerHtml.includes("contact"),
        "Indexed on Google": true // placeholder
      };

      const trust = {
        "Author bio presence": lowerHtml.includes("author"),
        "Contact email visibility": /[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,}/.test(lowerHtml),
        "Schema markup": lowerHtml.includes("application/ld+json") || lowerHtml.includes("itemprop")
      };

      const contentHeuristics = {
        "Paragraph depth": (html.match(/<p>/g)||[]).length>=5,
        "Stop-word ratio acceptable": (()=>{ 
          const stopWords=["the","is","at","which","on","and","a","an"];
          const words=bodyText.toLowerCase().split(/\s+/);
          const stopCount=words.filter(w=>stopWords.includes(w)).length;
          return (stopCount/words.length)<0.5;
        })(),
        "Unique sentences": (()=>{ 
          const sentences=bodyText.split(/[.!?]/).map(s=>s.trim()).filter(s=>s);
          const unique=new Set(sentences).size;
          return unique/sentences.length>0.7;
        })()
      };

      const internalLinks = {
        "Internal link count": (html.match(/<a /g)||[]).length>=5,
        "Contextual anchors": !lowerHtml.includes("click here")
      };

      const schema = {
        "JSON-LD detected": lowerHtml.includes("application/ld+json"),
        "Microdata detected": lowerHtml.includes("itemprop")||lowerHtml.includes("itemscope")
      };

      // --- Scoring ---
      let score = 0;
      let maxScore = 100;
      const weights = {technical:20, seo:15, policy:30, trust:10, contentHeuristics:15, internalLinks:5, schema:5};

      function calcScore(group, weight){
        const passed = Object.values(group).filter(v=>v).length;
        const total = Object.keys(group).length;
        return Math.round((passed/total)*weight);
      }

      score += calcScore(technical, weights.technical);
      score += calcScore(seo, weights.seo);
      score += calcScore(policy, weights.policy);
      score += calcScore(trust, weights.trust);
      score += calcScore(contentHeuristics, weights.contentHeuristics);
      score += calcScore(internalLinks, weights.internalLinks);
      score += calcScore(schema, weights.schema);

      // Hard rules
      if(!policy["Privacy Policy"]) maxScore = Math.min(maxScore,60);
      if(!technical["HTTPS"]) maxScore = Math.min(maxScore,50);
      if(!seo["Content depth"]) maxScore = Math.min(maxScore,55);
      if(score>maxScore) score=maxScore;

      // Verdict
      let verdictClass="low", verdictText="ðŸŸ¢ Low Approval Risk";
      if(score<60){ verdictClass="high"; verdictText="ðŸ”´ High Risk"; }
      else if(score<80){ verdictClass="medium"; verdictText="ðŸŸ¡ Medium Risk"; }

      // --- Output ---
      out.innerHTML = "";

      function renderSection(title, group){
        out.innerHTML += `<div class="section"><h3>â–¸ ${title}</h3>`;
        for(const key in group){
          out.innerHTML += `<div class="item">${key}</div>`;
        }
        out.innerHTML += `</div>`;
      }

      renderSection("Technical Check", technical);
      renderSection("SEO Check", seo);
      renderSection("Policy Compliance", policy);
      renderSection("Trust Signals", trust);
      renderSection("Content Heuristics", contentHeuristics);
      renderSection("Internal Links", internalLinks);
      renderSection("Schema Detection", schema);

      out.innerHTML += `<div class="score">â–¸ Final Score: ${score}/100</div>`;
      out.innerHTML += `<div class="verdict ${verdictClass}">Verdict badge: ${verdictText}</div>`;

      // Disclaimer + Branding
      const today = new Date().toLocaleDateString();
      out.innerHTML += `
        <div class="footer">
          <p><strong>Disclaimer:</strong> This pre-check estimates AdSense
